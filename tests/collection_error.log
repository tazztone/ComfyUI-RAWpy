============================= test session starts =============================
platform win32 -- Python 3.12.11, pytest-9.0.1, pluggy-1.6.0 -- C:\_stability_matrix\Data\Packages\Comfy-new\venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\_stability_matrix\Data\Packages\Comfy-new\custom_nodes\ComfyUI-RAWpy\tests
configfile: pytest.ini
plugins: anyio-4.11.0, hydra-core-1.3.2, asyncio-1.3.0, typeguard-4.4.4
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 25 items / 2 errors

<Package tests>
  <Package integration>
    <Module test_server.py>
      Integration tests for ComfyUI-RAWpy.
      
      These tests require a running ComfyUI server on port 8188.
      The run_tests.py script will auto-start the server if needed.
      <Class TestServerHealth>
        Verify ComfyUI server is healthy and accessible.
        <Function test_server_is_running>
          Verify the server responds to health checks.
      <Class TestNodeRegistration>
        Verify all RAWpy nodes are correctly registered with ComfyUI.
        <Function test_all_nodes_registered>
          Check that all expected nodes are available in the server.
        <Function test_node_count>
          Verify the correct number of nodes are registered.
      <Class TestNodeInputsOutputs>
        Verify node schemas are correctly defined.
        <Function test_load_raw_image_has_image_input>
          Verify LoadRawImage has the required 'image' input.
        <Function test_load_raw_image_has_image_output>
          Verify LoadRawImage outputs an IMAGE type.
    <Module test_server_startup.py>
      <Function test_server_startup>
        Verifies that ComfyUI server starts up correctly with the custom node loaded.
  <Package unit>
    <Module test_raw_processing.py>
      Unit tests for isolated RAW processing logic.
      
      These tests import `raw_processing` directly, avoiding all ComfyUI dependencies.
      <Class TestRawProcessing>
        Tests for the isolated process_raw function.
        <Function test_returns_correct_shape>
          Verify output tensor has correct shape (B, H, W, C).
        <Function test_16bit_normalization>
          Verify 16-bit values are normalized to [0, 1].
        <Function test_8bit_normalization>
          Verify 8-bit values are normalized to [0, 1].
        <Function test_custom_white_balance_passed>
          Verify custom white balance values are passed to rawpy.
        <Function test_demosaic_algorithm_passed>
          Verify demosaic algorithm enum is correctly resolved.
        <Function test_exposure_shift_passed>
          Verify exposure shift parameters are forwarded.
        <Function test_extract_jpeg_thumbnail>
          Verify JPEG thumbnail extraction.
        <Function test_extract_bitmap_thumbnail>
          Verify Bitmap thumbnail extraction.
        <Function test_no_thumbnail_fallback>
          Verify fallback when extract_thumb fails or returns None.
        <Function test_denoising_params_passed>
          Verify denoising parameters are forwarded.
        <Function test_half_size_passed>
          Verify half_size parameter is forwarded.
        <Function test_orientation_passed>
          Verify orientation parameter is forwarded.
        <Function test_colorspace_passed>
          Verify colorspace parameter is forwarded.
        <Function test_gamma_passed>
          Verify gamma tuple is forwarded.
        <Function test_chromatic_aberration_passed>
          Verify CA tuple is forwarded.
        <Function test_auto_wb_flag>
          Verify use_auto_wb flag is set.
        <Function test_thumbnail_dimensions_correction>
          Verify 2D thumbnail is expanded to 3D.
    <Module test_syntax.py>
      Unit tests for syntax validation and import rules.
      
      These tests ensure all Python files in the package are syntactically valid
      and follow strict import rules (no ComfyUI-specific imports at module level).
      <Class TestSyntax>
        Validate Python syntax across all source files.
        <Function test_all_files_parse>
          Verify all Python files are syntactically valid.
        <Function test_no_print_statements_in_production>
          Check for debug print statements (optional warning).

=================================== ERRORS ====================================
_____________ ERROR collecting integration/test_real_workflow.py ______________
ImportError while importing test module 'C:\_stability_matrix\Data\Packages\Comfy-new\custom_nodes\ComfyUI-RAWpy\tests\integration\test_real_workflow.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
..\..\..\..\..\Assets\Python\cpython-3.12.11-windows-x86_64-none\Lib\importlib\__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
integration\test_real_workflow.py:10: in <module>
    from nodes import LoadRawImage
..\nodes.py:7: in <module>
    from .raw_processing import (
E   ImportError: attempted relative import with no known parent package
_____________________ ERROR collecting unit/test_nodes.py _____________________
ImportError while importing test module 'C:\_stability_matrix\Data\Packages\Comfy-new\custom_nodes\ComfyUI-RAWpy\tests\unit\test_nodes.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
..\..\..\..\..\Assets\Python\cpython-3.12.11-windows-x86_64-none\Lib\importlib\__init__.py:90: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
unit\test_nodes.py:17: in <module>
    from nodes import LoadRawImage, LoadRawImageAdvanced
..\nodes.py:7: in <module>
    from .raw_processing import (
E   ImportError: attempted relative import with no known parent package
=========================== short test summary info ===========================
ERROR integration/test_real_workflow.py
ERROR unit/test_nodes.py
!!!!!!!!!!!!!!!!!!! Interrupted: 2 errors during collection !!!!!!!!!!!!!!!!!!!
==================== 25 tests collected, 2 errors in 1.59s ====================
